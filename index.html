<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìŠ¤ë§ˆì¼ ì í•‘</title>
  <style>
    /* CSSëŠ” â‘¡ì—ì„œ ì „ì²´ ìˆ˜ë¡ */
  </style>
</head>
<body>
  <h1>ìŠ¤ë§ˆì¼ ì í•‘ ğŸ•¹ï¸</h1>
  <div id="startScreen">
    <p>ìŠ¤í˜ì´ìŠ¤ë°” ë˜ëŠ” í„°ì¹˜ë¥¼ ëˆŒëŸ¬ ì í”„/ì‹œì‘í•˜ì„¸ìš”!</p>
    <p style="color: navy; font-size: 35px; font-weight: bold;"> 
        (ì í”„ ë†’ì´ëŠ” í„°ì¹˜ ê¸¸ì´ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤!) </p>         
    <button id="startBtn">START !</button>
    <p id="lastScore">ìµœì¢… ì ìˆ˜: 0ì </p>
  </div>
  <div id="game">
    <div id="character"><img src="character.png" alt="ìºë¦­í„°"></div>
    <div id="scoreBoard">ì ìˆ˜: <span id="score">0</span></div>
    <div id="gameOverMessage">ê²Œì„ ì˜¤ë²„!</div>
  </div>

  <!-- ğŸ”Š ì‚¬ìš´ë“œ íŒŒì¼ë“¤ -->
  <audio id="startSound" src="start.mp3" preload="auto" loop></audio>
  <audio id="bgMusic" src="bgmusic.mp3" preload="auto" loop></audio>
  <audio id="gameOverSound" src="gameover.mp3" preload="auto"></audio>
  <audio id="jumpSound" src="jump.mp3" preload="auto"></audio>

  <script>
    /* JavaScriptëŠ” â‘¢ì—ì„œ ì „ì²´ ìˆ˜ë¡ */
  </script>
</body>
</html>




<style>
  body {
    text-align: center;
    background: url("st.png") no-repeat center/cover;
    margin: 0;
    user-select: none;       /* âœ… ì „ì²´ ì„ íƒ ë°©ì§€ */
    -webkit-user-drag: none; /* âœ… ì „ì²´ ë“œë˜ê·¸ ë°©ì§€ */
  }
  body.gameStarted { background: white !important; }

  #game {
    position: relative;
    width: 100%;
    max-width: 1200px;
    aspect-ratio: 2 / 1; /* âœ… í™”ë©´ ë¹„ìœ¨ ìœ ì§€ */
    margin: 20px auto;
    background: url("bg.png") no-repeat center/cover;
    border: 2px solid #333;
    overflow: hidden;
    display: none;
  }

  #character {
    position: absolute;
    bottom: 0;
    left: 20%;
    width: 8%;
    height: auto;
    transform: translateY(0);
  }
  #character img {
    width: 100%;
    height: auto;
    pointer-events: none;
  }

  .obstacle { position: absolute; left: 100%; }
  .obstacle img { width: 100%; height: 100%; }
  .move { animation: moveObstacle var(--speed, 2s) linear forwards; }

  @keyframes moveObstacle { from { left: 100%; } to { left: -10%; } }

  #startScreen { margin-top: 5vh; position: relative; }
  #startScreen p {
    font-size: 4vw; font-weight: bold; text-align: center;
    margin-bottom: 12vh;
  }
  #startScreen button {
    font-size: 6vw; color: white; padding: 2vh 4vw;
    cursor: pointer; font-weight: bold; background: green;
  }
  #lastScore {
    font-size: 5vh; !important; margin-top: 5vh;
    color: red; font-weight: bold;
  }

  #scoreBoard {
    position: absolute;
    top: 3vh;
    left: 50%;
    transform: translateX(-50%);
    font-size: 5vw;
    font-weight: bold;
    color: black;
  }

  /* âœ… ìƒˆë¡œ ì¶”ê°€ëœ ì ìˆ˜ ë©”ì‹œì§€ */
  #scoreMessage {
    position: absolute;
    top: 9vh;               /* ì ìˆ˜íŒ(#scoreBoard)ë³´ë‹¤ ì•„ë˜ */
    left: 50%;
    transform: translateX(-50%);
    font-size: 2vw;
    font-weight: bold;
    color: red;             /* ë¹¨ê°„ìƒ‰ í‘œì‹œ */
    display: none;
  }

  h1 { font-size: 8vw; font-weight: bold; color: gray; }

  #gameOverMessage {
    display: none;
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 6vw;
    font-weight: bold;
    color: red;
    background: rgba(255,255,255,0.8);
    padding: 2vh 4vw;
    border: 3px solid red;
    border-radius: 10px;
  }

  /* âœ… ë°ìŠ¤í¬í†± ì „ìš© */
  @media (min-width: 768px) {
    #game {
      height: 600px;
    }
    #character {
      width: 80px;
      height: 80px;
      left: 250px;
    }
    #scoreBoard { font-size: 35px; }
    #scoreMessage { font-size: 25px; } /* ë°ìŠ¤í¬í†±ì—ì„œ ê¸€ì í¬ê¸° ì¡°ì • */
    h1 { font-size: 100px; }
    #startScreen p { font-size: 50px; }
    #startScreen p:nth-of-type(2) {
      position: absolute; top: 10%; left: 50%; transform: translateX(-50%); }
    #startScreen button { font-size: 70px; }
    #lastScore { font-size: 70px !important; }
    #gameOverMessage { font-size: 60px; }
  }
</style>




<script>
  const game = document.getElementById("game");
  const character = document.getElementById("character");
  const scoreDisplay = document.getElementById("score");
  const startScreen = document.getElementById("startScreen");
  const startBtn = document.getElementById("startBtn");
  const lastScoreDisplay = document.getElementById("lastScore");
  const gameOverMessage = document.getElementById("gameOverMessage");

  const jumpSound = document.getElementById("jumpSound");
  const startSound = document.getElementById("startSound");
  const bgMusic = document.getElementById("bgMusic");
  const gameOverSound = document.getElementById("gameOverSound");

  let score = 0, isJumping = false, gameStarted = false;
  let jumpedForObstacle = false;
  let lastJumpWasBig = false;
  let keyDownTime = 0;
  let clickTimer = null;
  let obstacleSpeed = 2;
  let minDelay = 800, maxDelay = 1700;
  let obstacleTimers = [];
  let touchStartTime = 0;

  // ì ìˆ˜ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­
  const scoreMessage = document.createElement("div");
  scoreMessage.id = "scoreMessage";
  game.appendChild(scoreMessage);

  function safePlay(audio) {
    if (!audio) return;
    audio.currentTime = 0;
    let playPromise = audio.play();
    if (playPromise !== undefined) {
      playPromise.catch(err => console.log("ì˜¤ë””ì˜¤ ì¬ìƒ ì‹¤íŒ¨:", err));
    }
  }

  function jump(height, isBig = false) {
    if (isJumping) return;
    isJumping = true;
    jumpedForObstacle = true;
    lastJumpWasBig = isBig;
    safePlay(jumpSound);

    let start = null, goingUp = true;
    function animateJump(timestamp) {
      if (!start) start = timestamp;
      let elapsed = timestamp - start;
      if (goingUp) {
        let newBottom = Math.min(elapsed, height);
        character.style.bottom = newBottom + "px";
        if (newBottom >= height) { goingUp = false; start = timestamp; }
      } else {
        let newBottom = Math.max(height - elapsed, 0);
        character.style.bottom = newBottom + "px";
        if (newBottom <= 0) { isJumping = false; return; }
      }
      requestAnimationFrame(animateJump);
    }
    requestAnimationFrame(animateJump);
  }

  function smallJump() { jump(300, false); }
  function bigJump() { jump(450, true); }

  function startGame() {
    startScreen.style.display = "none";
    game.style.display = "block";
    document.body.classList.add("gameStarted");
    score = 0; scoreDisplay.textContent = score + "ì ";
    gameStarted = true;
    isJumping = false; jumpedForObstacle = false;
    obstacleSpeed = 2; minDelay = 800; maxDelay = 1700;
    obstacleTimers.forEach(id => clearTimeout(id)); obstacleTimers = [];

    character.style.bottom = "0px";

    startSound.pause(); startSound.currentTime = 0;
    safePlay(bgMusic);
    spawnObstacle();
  }

  // ì ìˆ˜ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
  function showScoreMessage(text) {
    scoreMessage.textContent = text;
    scoreMessage.style.display = "block";
    setTimeout(() => {
      scoreMessage.style.display = "none";
    }, 1000);
  }

  // ì ìˆ˜ ê³„ì‚° í•¨ìˆ˜
  function calculateScore(obstacleSize, jumped, bigJumpUsed) {
    let baseScore;
    if (obstacleSize >= 150) {
      baseScore = 20;
    } else if (obstacleSize >= 100) {
      baseScore = 15;
    } else {
      baseScore = 10;
    }

    if (jumped) {
      if (bigJumpUsed) {
        showScoreMessage(`í´ì§! +${baseScore + 10}ì `);
        return baseScore + 10;
      } else {
        showScoreMessage(`ê¹¡ì´! +${baseScore}ì `);
        return baseScore;
      }
    } else {
      showScoreMessage("ì˜ í”¼í–ˆêµ°! â†’ +1ì ");
      return 1;
    }
  }

  function spawnObstacle() {
    if (!gameStarted) return;
    const obstacle = document.createElement("div");
    obstacle.classList.add("obstacle", "move");
    obstacle.style.setProperty("--speed", obstacleSpeed + "s");
    obstacle.innerHTML = "<img src='cactus.png' alt='ì¥ì• ë¬¼'>";

    const randomSize = Math.floor(Math.random() * 130) + 70;
    obstacle.style.width = randomSize + "px";
    obstacle.style.height = randomSize + "px";
    const maxJumpHeight = 300;
    const randomBottom = Math.floor(Math.pow(Math.random(), 2) * (maxJumpHeight - 

140));
    obstacle.style.bottom = randomBottom + "px";

    game.appendChild(obstacle);

    const checkCollision = setInterval(() => {
      const characterRect = character.getBoundingClientRect();
      const obstacleRect = obstacle.getBoundingClientRect();
      const marginTop = 5, marginBottom = 5, marginLeft = 17, marginRight = 10;
      if (
        characterRect.left + marginLeft < obstacleRect.right - marginRight &&
        characterRect.right - marginRight > obstacleRect.left + marginLeft &&
        characterRect.top + marginTop < obstacleRect.bottom - marginBottom &&
        characterRect.bottom - marginBottom > obstacleRect.top + marginTop
      ) {
        gameOver();
        clearInterval(checkCollision);
        obstacle.style.animationPlayState = "paused";
      }
    }, 50);

    obstacle.addEventListener("animationend", () => {
      clearInterval(checkCollision);
      if (game.contains(obstacle) && gameStarted) {
        const gainedScore = calculateScore(randomSize, jumpedForObstacle, 

lastJumpWasBig);
        score += gainedScore;
        scoreDisplay.textContent = score + "ì ";

        jumpedForObstacle = false;
        lastJumpWasBig = false;

        if (score % 50 === 0) {
          if (obstacleSpeed > 0.5) obstacleSpeed -= 0.2;
          if (minDelay > 400) { minDelay -= 100; maxDelay -= 100; }
        }

        game.removeChild(obstacle);
      }
    });

    const randomDelay = Math.random() * maxDelay + minDelay;
    const timerId = setTimeout(() => { if (gameStarted) spawnObstacle(); }, randomDelay);
    obstacleTimers.push(timerId);
  }

  function gameOver() {
    gameStarted = false;
    gameOverMessage.style.display = "block";
    obstacleTimers.forEach(id => clearTimeout(id));
    obstacleTimers = [];
    bgMusic.pause(); safePlay(gameOverSound);

    gameOverSound.onended = () => {
      gameOverMessage.style.display = "none";
      game.style.display = "none";
      startScreen.style.display = "block";
      document.body.classList.remove("gameStarted");
      safePlay(startSound);
      lastScoreDisplay.textContent = "ìµœì¢… ì ìˆ˜: " + score + "ì ";
      score = 0; scoreDisplay.textContent = score + "ì ";
    };
  }

  /* ì´ë²¤íŠ¸ ì²˜ë¦¬ */
  startBtn.addEventListener("click", e => { e.stopPropagation(); startGame(); });

  document.addEventListener("keydown", e => {
    if (e.code === "Space") keyDownTime = Date.now();
  });

  document.addEventListener("keyup", e => {
    if (e.code === "Space") {
      const pressDuration = Date.now() - keyDownTime;
      if (gameStarted) {
        pressDuration < 140 ? smallJump() : bigJump();
      } else if (startScreen.style.display === "block") {
        startGame();
      }
    }
  });

  document.addEventListener("click", e => {
    if (e.target.id === "startBtn") return;
    if (gameStarted) {
      if (clickTimer) clearTimeout(clickTimer);
      clickTimer = setTimeout(() => { smallJump(); clickTimer = null; }, 200);
    } else if (startScreen.style.display === "block") {
      startGame();
    }
  });

  document.addEventListener("dblclick", e => {
    if (e.target.id === "startBtn") return;
    e.preventDefault();
    if (gameStarted) {
      if (clickTimer) { clearTimeout(clickTimer); clickTimer = null; }
      bigJump();
    } else if (startScreen.style.display === "block") {
      startGame();
    }
  });

  document.addEventListener("touchstart", e => {
    if (e.target.id === "startBtn") return;
    if (gameStarted) {
      touchStartTime = Date.now();
      e.preventDefault();
      return;
    }
    if (startScreen.style.display === "block") {
      startGame();
    }
  });

    document.addEventListener("touchend", e => {
    if (!gameStarted) return;
    const touchDuration = Date.now() - touchStartTime;
    if (touchDuration < 170) {
      smallJump(); // ì§§ì€ í„°ì¹˜ â†’ ì‘ì€ ì í”„
    } else {
      bigJump();   // ê¸´ í„°ì¹˜ â†’ í° ì í”„
    }
  });
</script>


